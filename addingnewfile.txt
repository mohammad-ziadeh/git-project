new code from the main